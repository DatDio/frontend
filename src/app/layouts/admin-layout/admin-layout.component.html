<div class="admin-layout">
  <!-- Top Navigation -->
  <nav class="navbar navbar-expand navbar-dark bg-dark admin-navbar">
    <div class="container-fluid">
      <button class="btn btn-sm btn-outline-light me-3" (click)="toggleSidebar()">
        <i class="bi bi-list"></i>
      </button>
      <a class="navbar-brand" routerLink="/admin">
        <strong>EmailSieuRe Admin</strong>
      </a>
      <ul class="navbar-nav ms-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
            <i class="bi bi-person-circle"></i>
            {{ (authService.currentUser$ | async)?.email }}
          </a>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" routerLink="/admin/profile">Profile</a></li>
            <li><a class="dropdown-item" routerLink="/admin/settings">Settings</a></li>
            <li>
              <hr class="dropdown-divider">
            </li>
            <li><a class="dropdown-item" (click)="logout()" style="cursor: pointer;">Logout</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <div class="admin-container">
    <!-- Sidebar -->
    <aside class="admin-sidebar" [class.sidebar-open]="sidebarOpen">
      <nav class="nav flex-column">
        <a class="nav-link" routerLink="/admin/dashboard" routerLinkActive="active">
          <i class="bi bi-speedometer2"></i>
          <span>Trang chủ</span>
        </a>

        <a class="nav-link" routerLink="/admin/mail-management" routerLinkActive="active">
          <i class="bi bi-envelope"></i>
          <span>Quản lý sản phẩm</span>
        </a>

        <a class="nav-link" routerLink="/admin/categories-management" routerLinkActive="active">
          <i class="bi bi-envelope"></i>
          <span>Quản lý danh mục</span>
        </a>

        <a class="nav-link" routerLink="/admin/users-management" routerLinkActive="active">
          <i class="bi bi-people"></i>
          <span>Quản lý người dùng</span>
        </a>

        <a class="nav-link" routerLink="/admin/orders-management" routerLinkActive="active">
          <i class="bi bi-bag"></i>
          <span>Quản lý đơn hàng</span>
        </a>

        <a class="nav-link" routerLink="/admin/transactions-management" routerLinkActive="active">
          <i class="bi bi-receipt"></i>
          <span>Quản lý giao dịch</span>
        </a>

        <a class="nav-link" routerLink="/admin/reg-management" routerLinkActive="active">
          <i class="bi bi-person-plus"></i>
          <span>Quản lý Reg</span>
        </a>

        <a class="nav-link" routerLink="/admin/oauth2-management" routerLinkActive="active">
          <i class="bi bi-key"></i>
          <span>Quản lý OAuth2</span>
        </a>

        <!-- External API Expandable Menu -->
        <div class="nav-item-expandable">
          <a class="nav-link" (click)="toggleExternalApiMenu()" [class.expanded]="externalApiExpanded"
            [class.active]="externalApiExpanded">
            <i class="bi bi-plug"></i>
            <span>External API</span>
            <i class="bi bi-chevron-down expand-icon" [class.rotated]="externalApiExpanded"></i>
          </a>
          <div class="submenu" [class.show]="externalApiExpanded">
            <a class="nav-link submenu-item" routerLink="/admin/external-api/providers" routerLinkActive="active">
              <i class="bi bi-server"></i>
              <span>Providers</span>
            </a>
            <a class="nav-link submenu-item" routerLink="/admin/external-api/mappings" routerLinkActive="active">
              <i class="bi bi-link-45deg"></i>
              <span>Mappings</span>
            </a>
          </div>
        </div>

        <a class="nav-link" routerLink="/admin/settings" routerLinkActive="active">
          <i class="bi bi-gear"></i>
          <span>Cài đặt</span>
        </a>
        <a class="nav-link" routerLink="/admin/security" routerLinkActive="active">
          <i class="bi bi-shield-lock"></i>
          <span>Bảo mật</span>
        </a>
        <a class="nav-link" routerLink="/admin/ranks-management" routerLinkActive="active">
          <i class="bi bi-trophy"></i>
          <span>Quản lý thứ hạng</span>
        </a>
        <a class="nav-link" routerLink="/admin/api-doc" routerLinkActive="active">
          <i class="bi bi-file-code"></i>
          <span>API Doc</span>
        </a>
        <hr>
        <a class="nav-link" routerLink="/">
          <i class="bi bi-arrow-left"></i>
          <span>Back to Site</span>
        </a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="admin-main" [class.sidebar-open]="sidebarOpen">
      <div class="container-fluid py-4">
        <router-outlet></router-outlet>
      </div>
    </main>
  </div>
</div>